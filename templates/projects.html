{% extends 'base/dashboard.html' %}

{% block projectDetail %}
    {% block customcss %}
        <style type="text/css">
            html, body {
                background: #e8e7e78a;
            }
        </style>
    {% endblock %}
    {% include 'projects/overview.html' %}
    {% block chartblock %}
        <span id="result" style="float: right; color: #FF0000"></span>
        <div class="form-inline" style="padding-top: 20px">
            <div class="form-group">
                <label for="exampleInputName2">文件名</label>
                <input type="text" class="form-control" id="sign_file" placeholder="account">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail2">登录网址</label>
                <input type="text" class="form-control" id="sign_site"
                       placeholder="http://zwu.hustoj.com/loginpage.php">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail2">用户数</label>
                <input type="text" class="form-control" id="sign_num" placeholder="10">
            </div>
            <a id="test_sign" class="btn btn-default">注册用户</a>
        </div>
        <div class="form-inline" style="padding-top: 20px">
            {% csrf_token %}
            <div class="form-group">
                <label for="exampleInputName2">刚注册的文件</label>
                <input type="text" class="form-control" id="login_file" placeholder="account">
            </div>
            <a id="test_upload" class="btn btn-default" id="login_upload">上传</a>
            <div class="form-group">
                <label for="exampleInputEmail2">登录网址</label>
                <input type="text" class="form-control" id="login_site"
                       placeholder="http://zwu.hustoj.com/loginpage.php">
            </div>
            <a id="test_login" class="btn btn-default">登录测试</a>
        </div>
        <div class="form-inline" style="padding-top: 20px">
            <div class="form-group">
                <label for="exampleInputName2">用户名文件</label>
                <input type="text" class="form-control" id="problem_file" placeholder="account">
            </div>
            <a id="test_problem" class="btn btn-default">针对性测试</a>
        </div>
        <div class="form-inline" style="padding-top: 20px">
            <div class="form-group">
                <label for="exampleInputName2">获取站点网址深度</label>
                <input type="text" class="form-control" id="force_deep" placeholder="1或2或3.">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail2">登录网址</label>
                <input type="text" class="form-control" id="force_site"
                       placeholder="http://zwu.hustoj.com/loginpage.php">
            </div>
            <div class="form-group">
                <label for="exampleInputName2">用户名文件</label>
                <input type="text" class="form-control" id="force_file" placeholder="account">
            </div>
            <a id="test_force" class="btn btn-default">针对性压力测试</a>
        </div>
        {% block customjs %}
            <script type="text/javascript">
                $('#test_sign').click(function () {
                    var filename = $('#sign_file').val();
                    var site = $('#sign_site').val();
                    var num = $('#sign_num').val();
                    if(filename == ''){
                        $('#result').html('文件名不能为空');
                    }
                    else if (site != 'http://zwu.hustoj.com/loginpage.php') {
                        $('#result').html('登录网址错误，例：http://zwu.hustoj.com/loginpage.php');
                    }
                    else if (typeof num != "number" && num <= 0) {
                        $('#result').html('num大于0，且为整数');
                    }
                    else {
                        $.ajax({
                            url: 'test_sign/',
                            type: 'GET',
                            data: {
                                filename: filename,
                                site: site,
                                num: num
                            },
                            {#headers: {"X-CSRFToken": $.cookie('csrftoken')},#}
                            beforeSend: function () {
                                // 禁用按钮防止重复提交
                                $('#result').html('正在注册，请稍等......');
                            },
                            success: function (res) {
                                $('#result').html(res.message);
                                /**
                                 if ('success' === res.message) {
                                console.log(res.message)
                            } else {
                                $('#result').html(res.message);
                            }
                                 **/
                            }
                        })
                    }
                })

            </script>
        {% endblock %}
    {% endblock %}
{% endblock %}